# 字体反爬 

## 字体反爬原理 

1.网站开发者 自己创造字体  ，每个文字都有其代号，每个文字在网页中不会显示最终效果 ，而是显示它的代号 

比如 `&#xe61f;`  这是个代号 对应的最终效果是文字或者数字  ，即使你爬取下来拿到的也是代号  不是文字本身   

2.创造字体费时费力  中国3000多汉字都实现  字体得有将近  几十M   产品不可能牺牲加载的速度去保证反爬效果，所以说 只有部分字体会单独创建  一般都是数字  其它还是系统自带的字体  



## 寻找自定义的字体  

1. 考虑网页渲染性能，把自定义的字体编码成base64  我们在网页中查找 @font-face获取编码再用python进行解码然后保存到本地    
2. 直接把字体文件放到服务器上 前端通过 url 进行加载       比如斗音

## 分析  

1.将字体文件转成XML  需要安装 fontTools 

```
pip install font-Tools
```

```
def analysis_font():
    baseFont = TTFont('testt.woff')
    baseFont.saveXML('douyin.xml')
```

`Cmap`存放的是code 和name的关系   

`glyf` 存放的是  字体的形状  name 和形状   



code的是显示在页面上的    

code->name->形状 

进而可以拿到 code 和形状的关系  

因为字体形状是不变的   

我们需要预定定义号形状和最终文字的关系 

​					

字体的形状                        code  									name 							字体形状 

文字 									name 									  形状								文字

----------------

⬇

需要提前定义好

name 和最终的文字 提前定义好 code ->name->最终文字

## 解决方案  





